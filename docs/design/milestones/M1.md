# Milestone M1 — Hatch and Work (Detailed Design)

## Goals
Production-usable baseline with Bearer auth, persistence, both export paths, async spawn, and complete operator/API docs.

## Deliverables
- FastMCP 2 server skeleton (no client pollution)
- Auth: bearer tokens (hashed at boot); owner propagation to labels
- Docker backend: `attach_or_spawn`, `stop/remove`, named volume at `/work`
- Shell & FS tools with streaming IO and errors
- List/continue for containers, volumes, snapshots
- Exports:
  - Control-plane: `EXPORT_ROOT`, tar.zst/dir, atomic writes, MANIFEST.json
  - Runner publish mount via Mount Broker (alias + realpath checks, RO default)
- Pre-pull on boot; readiness events
- Docs (operators, API, security, clients) and smoke tests
- **Docs site:** set up **MkDocs** (theme: `material`), wire to GitHub Pages; publish 
  - Sources under `docs/` consolidated;
  - Navigation: Overview, Install, Config, Security, API, Clients, ADRs, KB;
  - CI: build docs on PR and publish on `main` releases.
- **CI bootstrap:** ruff, pyright, smoke job placeholders.

## Acceptance Criteria
- End-to-end: spawn → write file → read → export (both paths) → reattach → stop/remove
- Owner-scoped listing works; labels applied on resources
- RO by default for bind mounts; RW only on whitelisted alias; warnings in audit
- MkDocs site builds locally and via CI; site published for M1

## Out of Scope
- OIDC enforcement
- Quotas/GC, S3/MinIO, registry publish
